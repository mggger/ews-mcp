# EWS MCP Server - OAuth2 Authentication Configuration
# For Office 365 / Microsoft 365 (Production environments)

# ============================================================================
# Exchange Server Configuration
# ============================================================================

# Office 365 EWS endpoint (usually this URL for all Office 365)
EWS_SERVER_URL=https://outlook.office365.com/EWS/Exchange.asmx

# Your Office 365 email address
EWS_EMAIL=user@company.com

# Autodiscovery (recommended for Office 365)
EWS_AUTODISCOVER=true

# ============================================================================
# OAuth2 Authentication (Most Secure)
# ============================================================================

EWS_AUTH_TYPE=oauth2

# Azure AD Application (Client) ID
# Get from: Azure Portal > App registrations > Your App > Overview
EWS_CLIENT_ID=your-azure-app-client-id

# Azure AD Client Secret
# Get from: Azure Portal > App registrations > Your App > Certificates & secrets
EWS_CLIENT_SECRET=your-azure-app-client-secret

# Azure AD Tenant (Directory) ID
# Get from: Azure Portal > App registrations > Your App > Overview
EWS_TENANT_ID=your-azure-tenant-id

# ============================================================================
# Server Configuration
# ============================================================================

MCP_SERVER_NAME=ews-mcp-server
MCP_TRANSPORT=stdio
LOG_LEVEL=INFO

# ============================================================================
# Performance Settings
# ============================================================================

ENABLE_CACHE=true
CACHE_TTL=300
CONNECTION_POOL_SIZE=10
REQUEST_TIMEOUT=30

# ============================================================================
# Rate Limiting
# ============================================================================

RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=25

# ============================================================================
# Feature Flags (Enable/Disable specific tools)
# ============================================================================

ENABLE_EMAIL=true
ENABLE_CALENDAR=true
ENABLE_CONTACTS=true
ENABLE_TASKS=true
ENABLE_FOLDERS=true
ENABLE_ATTACHMENTS=true

# ============================================================================
# Security
# ============================================================================

ENABLE_AUDIT_LOG=true
MAX_ATTACHMENT_SIZE=157286400

# ============================================================================
# OAuth2 Setup Instructions
# ============================================================================
#
# 1. Register app in Azure AD:
#    - Go to: https://portal.azure.com
#    - Azure Active Directory > App registrations > New registration
#    - Name: "EWS MCP Server"
#    - Click "Register"
#
# 2. Add API Permissions:
#    - Go to: API permissions > Add a permission
#    - Select "Office 365 Exchange Online"
#    - Select "Application permissions"
#    - Add: full_access_as_app (or specific permissions)
#    - Click "Grant admin consent"
#
# 3. Create Client Secret:
#    - Go to: Certificates & secrets > New client secret
#    - Description: "EWS MCP Secret"
#    - Expires: Choose duration (recommended: 24 months)
#    - Click "Add"
#    - **COPY THE SECRET VALUE IMMEDIATELY** (won't be shown again)
#
# 4. Get IDs:
#    - Go to: Overview
#    - Copy "Application (client) ID" to EWS_CLIENT_ID above
#    - Copy "Directory (tenant) ID" to EWS_TENANT_ID above
#    - Paste client secret value to EWS_CLIENT_SECRET above
#
# 5. Update this file with your values
#
# 6. Run: docker run -d --env-file .env ghcr.io/azizmazrou/ews-mcp:latest
#
# For Claude Desktop, use this configuration:
# {
#   "mcpServers": {
#     "ews": {
#       "command": "docker",
#       "args": ["run", "-i", "--rm", "--env-file", "/path/to/.env", "ghcr.io/azizmazrou/ews-mcp:latest"]
#     }
#   }
# }
